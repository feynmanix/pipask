import pytest
from pipask.infra.vulnerability_details import VulnerabilitySeverity


@pytest.mark.parametrize(
    "input_values,expected",
    [
        # Single values
        ((VulnerabilitySeverity.CRITICAL,), VulnerabilitySeverity.CRITICAL),
        ((VulnerabilitySeverity.LOW,), VulnerabilitySeverity.LOW),
        # Multiple values
        (
            (VulnerabilitySeverity.LOW, VulnerabilitySeverity.HIGH, VulnerabilitySeverity.MODERATE),
            VulnerabilitySeverity.HIGH,
        ),
        # None values
        ((None,), None),
        ((None, None), None),
        # Mixed values
        ((None, VulnerabilitySeverity.MODERATE, None, VulnerabilitySeverity.CRITICAL), VulnerabilitySeverity.CRITICAL),
        # Empty
        ((), None),
    ],
)
def test_vulnerability_severity_get_worst(input_values, expected):
    assert VulnerabilitySeverity.get_worst(*input_values) == expected
